var HD = function () { "use strict"; function x() { var a = r("accessToken"); return a ? "Bearer " + window.btoa(a) : null } function y(a, b, c, d) { f({ type: "GET", url: a, authzheader: void 0 }, function (a) { 200 === a.status || 201 === a.status ? b(a) : c(a) }, function (a) { var b = a; try { b = JSON.parse(a.response), b.status = a.status } catch (d) { } c(b) }, d()) } function z(a, b, c, e) { var g, h; g = d("/file"), h = o(a, r("accessToken")), h.data && (g += "?" + h.data), f({ type: "GET", url: g, authzheader: h.oAuthHeader, responseType: "blob" }, function (a) { 200 === a.status ? b(a.response) : c(a) }, function (a) { c(a) }, function (a) { e(a) }) } function A(a, b, c, e) { var g, h; g = d("/file/thumbnail"), h = o(a, r("accessToken")), h.data && (g += "?" + h.data), f({ type: "GET", url: g, authzheader: h.oAuthHeader, responseType: "blob" }, function (a) { 200 === a.status ? b(a.response) : c(a) }, function (a) { c(a) }, function (a) { e(a) }) } var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, a = "0.0.1", w = { accessToken: null, clientId: null, responseType: null, userScope: null, grantScope: null, redirectUri: null, state: null, language: null, userName: null, accountId: null, apiUrl: null }; return f = function (a, b, c, d) { var f, g, h, i, j, k, e = t(); if (e.onreadystatechange = function () { e._canceled || (4 === e.readyState ? (e.status >= 200 && e.status < 300 ? b(e) : c(e), e.onreadystatechange = function () { }) : d && d(e)) }, e.open(a.type || "GET", a.url, !0, a.user, a.password), e.responseType = a.responseType || "", i = { "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "If-Modified-Since": "Mon, 27 Mar 1972 00:00:00 GMT" }, a.headers = a.headers || i, a.authzheader && (a.headers.Authorization = a.authzheader), Object.keys(a.headers || {}).forEach(function (b) { e.setRequestHeader(b, a.headers[b]) }), j = "", a.data) for (f in a.data) if (a.data.hasOwnProperty(f)) if ("array" === f) for (k = a.data[f], g = 0; g < k.length; g++) { j.length > 0 && (j += "&"); for (h in k[g]) k[g].hasOwnProperty(h) && (j += h + "=" + encodeURIComponent(k[g][h])) } else j.length > 0 && (j += "&"), j += f + "=" + encodeURIComponent(a.data[f]); e.send(j) }, g = function (a, b) { j("/user/me", null, function (b) { r({ userName: b.alias }), r({ accountId: b.account }), a(b) }, function (a) { b(a) }, function () { }) }, i = function () { r({ accessToken: void 0 }), r({ userName: void 0 }), r({ accountId: void 0 }), r({ userScope: void 0 }) }, b = function () { var a = e() + "/authorize?response_type=" + HD.options("responseType") + "&client_id=" + HD.options("clientId"); return void 0 !== HD.options("grantScope") && (a += "&scope=" + HD.options("grantScope")), void 0 !== HD.options("redirectUri") && (a += "&redirect_uri=" + HD.options("redirectUri")), void 0 !== HD.options("state") && (a += "&state=" + HD.options("state")), void 0 !== HD.options("language") && (a += "&lang=" + HD.options("language")), a }, e = function () { return "https://www.hidrive.strato.com/oauth2" }, u = function () { return "https://api.hidrive.strato.com/2.1" }, c = function () { return void 0 !== r("accessToken") }, s = function (a, b) { return Object.prototype.hasOwnProperty.call(a, b) }, r = function (a) { var b; if (!a) return w; if ("[object String]" === Object.prototype.toString.call(a)) return s(w, a) ? w[a] : null; for (b in w) w.hasOwnProperty(b) && s(w, b) && s(a, b) && (w[b] = a[b]) }, d = function (a) { var b = u(); return ("/token" === a.substr(0, "/token".length) || "/revoke" === a.substr(0, "/revoke".length)) && (b = e()), b += a }, h = function () { i() }, v = function (a, b) { var d = { access_token: r("accessToken") }; k("POST", "/tokeninfo", d, function (b) { a(b) }, function (a) { b(a) }, function () { }) }, l = function (a, b, c, d, e) { return k("POST", a, b, c, d, e) }, m = function (a, b, c, d, e) { return k("PUT", a, b, c, d, e) }, n = function (a, b, c, d, e) { return k("DELETE", a, b, c, d, e) }, o = function (a, b) { var d, e, f, g, c = {}; if (a) for (d in a) a.hasOwnProperty(d) && (c[d] = encodeURIComponent(a[d])); f = "", g = ""; for (e in c) c.hasOwnProperty(e) && (g && (g += "&"), g += e + "=" + c[e]); return b && (f += "Bearer " + window.btoa(b)), { oAuthHeader: f, data: g } }, j = function (a, b, c, e, g) { var h, i, j; h = d(a), i = o(b, r("accessToken")), i.data && (h += "?" + i.data), j = { type: "GET", url: h, authzheader: x() }, f(j, function (a) { if (200 === a.status || 201 === a.status) { var b = a.responseText; try { b = JSON.parse(b) } catch (d) { } finally { c(b) } } else 204 === a.status ? c(a) : e(a) }, function (a) { var b = a.responseText; try { b = JSON.parse(b), b.status = a.status } catch (c) { } e(b) }, g()) }, k = function (a, b, c, e, g, h) { var i; i = d(b), f({ type: a, url: i, authzheader: x(), data: c }, function (a) { if (200 === a.status || 201 === a.status) { var b = a.responseText; try { b = JSON.parse(b) } catch (c) { } finally { e(b) } } else 204 === a.status ? e(a) : g(a) }, function (a) { var b = a.responseText; try { b = JSON.parse(b), b.status = a.status } catch (c) { } g(b) }, h()) }, q = function (a) { var c, d, b = {}, e = ""; if (a) for (c in a) a.hasOwnProperty(c) && (b[c] = a[c]); for (d in b) b.hasOwnProperty(d) && (e && (e += "&"), e += d + "=" + b[d]); return e }, p = function (a) { var b, c; return b = HD.getFullUrl("/file"), c = q(a), c && (b += "?" + c), b }, t = function () { try { return new XMLHttpRequest } catch (a) { throw new Error("Browser is not CORS capable") } }, { options: r, getLoginUrl: b, getApiUrl: u, getOAuthUrl: e, version: a, isAuthorized: c, get: j, getStatic: y, logout: h, post: l, put: m, "delete": n, getAuthorizationHeader: x, getFile: z, getThumbnail: A, sessionClear: i, getFullUrl: d, getFileTransactionUrl: p, getTokenInfo: v } }();